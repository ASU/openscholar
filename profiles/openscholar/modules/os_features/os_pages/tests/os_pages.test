<?php
/**
 * Basic tests for OS Pages.
 */
class OSPagesContextTest extends DrupalWebTestCase {
  /**
   * Test info.
   */
  public static function getInfo() {
    return array(
      'name' => t('OS Pages'),
      'description' => t('Tests for OS Pages feature.'),
      'group' => t('OS Pages'),
    );
  }

  /**
   * Set up test.
   */
  public function setUp() {
    parent::setUp(
      'context'
//      'purl',
//      'spaces',
//      'og',
//      'spaces_og'
    );
  }

  /**
   * Run context test.
   */
  public function testContextActive() {
  	
  	//Create Page Node
  	$node = array(
      'title' => 'A Test Page',
      'type' => 'page',
    );
    $page_node = $this->drupalCreateNode($node);
    
    //Act on the page node
    context_node_condition($page_node,'view');
    
    //Assert that this context is in fact active
    $result = $this->assertTrue(context_isset('context','openscholar-feature-pages'), "Context 'openscholar-feature-pages' active when viewing node type 'page'.");
    
    //If this failed lets log the active contexts
    if(!$result){
    	//Debugging
      $this->verbose('Active Contexts: ' . var_export(context_active_contexts(), TRUE));
    }
  }
}